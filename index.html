<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cece Wrapped 2025</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --primary-color: #d63384; --tree-green: #2e8b57; --bg-color: #fff5f5; }
        body { font-family: 'Montserrat', sans-serif; margin: 0; background-color: var(--bg-color); text-align: center; overflow-x: hidden; }
        
        .page { display: none; min-height: 100vh; padding: 20px; box-sizing: border-box; }
        .active { display: flex; flex-direction: column; align-items: center; }

        /* Trang 1 Styles */
        h1 { font-family: 'Dancing Script', cursive; font-size: 3rem; color: var(--primary-color); margin: 20px 0 10px; }
        .recap-collage { position: relative; width: 100%; max-width: 500px; height: 350px; margin: 20px auto; }
        .recap-collage img { position: absolute; width: 160px; height: 110px; object-fit: cover; box-shadow: 0 5px 15px rgba(0,0,0,0.2); border-radius: 10px; transition: 0.3s; }
        
        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(var(--rot)); }
            50% { transform: translateY(-10px) rotate(calc(var(--rot) + 2deg)); }
        }
        .img-1 { top: 5%; left: 5%; --rot: -10deg; animation: float 4s infinite; }
        .img-2 { top: 0%; right: 5%; --rot: 8deg; animation: float 5s infinite 1s; }
        .img-3 { bottom: 10%; left: 8%; --rot: -5deg; animation: float 3.5s infinite 0.5s; }
        .img-4 { bottom: 5%; right: 10%; --rot: 12deg; animation: float 6s infinite 2s; }
        .img-5 { top: 30%; left: 32%; --rot: 0deg; z-index: 5; animation: float 4.5s infinite; }

        /* Trang 2 Styles */
#page2 {
    display: none;
    flex-direction: column;
    align-items: center;
    justify-content: center; /* Đưa nội dung vào giữa theo chiều dọc */
    width: 100%;
    min-height: 100vh;
    background-color: #fff5f5;
    box-sizing: border-box;
    padding: 20px;
    overflow: hidden;
}

/* Khung chứa cây: Cố định kích thước để không bị 'bay' */
#tree-area {
    position: relative;
    width: 350px;       /* Chiều ngang cố định để tính % hoa cho chuẩn */
    height: 400px;      /* Chiều cao cố định */
    margin: 20px auto;
    background-image: url('Images/growingtrees.gif');
    background-size: contain;
    background-repeat: no-repeat;
    background-position: bottom center;
}

/* Nút bấm: Sửa lỗi bị dài ngoằng */
.cta-btn { 
    display: inline-block; 
    width: fit-content; 
    min-width: 180px; 
    background: var(--primary-color); 
    color: white; 
    border: none; 
    padding: 12px 25px; 
    border-radius: 50px; 
    font-weight: bold; 
    cursor: pointer; 
}

/* Tiêu đề trang 2 */
.thank-you-msg {
    font-family: 'Dancing Script', cursive;
    color: var(--tree-green);
    font-size: 1.8rem;
    margin: 0;
}
        @keyframes bloom {
            0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }
        .flower-name { font-size: 10px; background: white; padding: 2px 6px; border-radius: 5px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-top: 2px; }

        .cta-btn { background: var(--primary-color); color: white; border: none; padding: 12px 25px; border-radius: 50px; font-weight: bold; cursor: pointer; transition: 0.3s; }
        .cta-btn:hover { transform: scale(1.05); opacity: 0.9; }
    </style>
</head>
<body>

    <div id="page1" class="page active">
        <h1>Cece Wrapped 2025</h1>
        <p>Thank you for being a part of my 2025!</p>
        <div class="recap-collage">
            <img src="Images/Page 1-1.PNG" class="img-1">
            <img src="Images/Page 1-2.png" class="img-2">
            <img src="Images/Page 1-3.JPG" class="img-3">
            <img src="Images/Page 1-4.png" class="img-4">
            <img src="Images/Page 1-5.jpeg" class="img-5">
        </div>
        <input type="text" id="userName" placeholder="What's your name?" style="padding: 10px; border-radius: 20px; border: 1px solid #d63384; margin-bottom: 15px;">
        <button class="cta-btn" onclick="startJourney()">Click here to see you in my journey</button>
    </div>

    <div id="page2" class="page">
    <h2 class="thank-you-msg">Thank you for being my beautiful flower!</h2>
        <div id="tree-area"></div>
        <div style="width: 100%; display: flex; justify-content: center; margin-top: 10px;">
        <button class="cta-btn" style="background: var(--tree-green);" onclick="location.reload()">
            Back to homepage
        </button>
    </div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getDatabase, ref, push, onChildAdded } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

    const firebaseConfig = {
        apiKey: "AIzaSyC5ZBRxI1R3a6hQr-d8_XW2Gc3POjgJCCE",
        authDomain: "cecewrapped.firebaseapp.com",
        databaseURL: "https://cecewrapped-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "cecewrapped",
        storageBucket: "cecewrapped.firebasestorage.app",
        messagingSenderId: "19184758276",
        appId: "1:19184758276:web:f718eefc721e51a71ccf51"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const flowersRef = ref(db, 'flowers');

    // Hàm vẽ hoa (SỬ DỤNG %)
    function drawFlower(x, y, name) {
        const treeArea = document.getElementById('tree-area');
        const container = document.createElement('div');
        container.className = 'flower-container';
        container.style.left = x + '%';
        container.style.top = y + '%';

        container.innerHTML = `
            <img src="Images/Sunflower.png" style="width:45px; height:auto;">
            <span class="flower-name">${name}</span>
        `;
        treeArea.appendChild(container);
    }

    // Lắng nghe hoa cũ và hoa mới mọc
    onChildAdded(flowersRef, (snapshot) => {
        const data = snapshot.val();
        drawFlower(data.x, data.y, data.name);
    });

    window.startJourney = function() {
    const nameInput = document.getElementById('userName').value.trim() || "Friend";
    document.getElementById('page1').style.display = 'none';
    document.getElementById('page2').style.display = 'flex';

    setTimeout(() => {
        // Tọa độ chuẩn cho cây Sunflower của bạn
        // X: 30% đến 70% (giữa cây)
        // Y: 20% đến 45% (vùng lá xanh)
        const randomX = Math.floor(Math.random() * 40) + 30; 
        const randomY = Math.floor(Math.random() * 25) + 20; 

        push(flowersRef, { 
            x: randomX, 
            y: randomY,
            name: nameInput
        });
    }, 1200);
};
</script>
</body>
</html>
